<div class="form-container">
  <div class="form-card">
    <div class="form-header">
      <h1>{{ isEditMode ? '‚úèÔ∏è Editar Juego' : 'üéÆ Agregar Nuevo Juego' }}</h1>
      <p class="form-subtitle">{{ isEditMode ? 'Actualiza la informaci√≥n de tu videojuego' : 'Completa los datos para agregar un nuevo videojuego a tu colecci√≥n' }}</p>
    </div>

    <form [formGroup]="gameForm" (ngSubmit)="onSubmit()" novalidate>
      
      <!-- T√≠tulo -->
      <div class="form-group">
        <label for="titulo">
          T√≠tulo del Juego <span class="required">*</span>
        </label>
        <input 
          type="text" 
          id="titulo" 
          formControlName="titulo"
          placeholder="Ej: The Legend of Zelda: Breath of the Wild"
          [class.is-invalid]="hasError('titulo')"
          [class.is-valid]="gameForm.get('titulo')?.valid && gameForm.get('titulo')?.touched"
        />
        <span class="error-message" *ngIf="hasError('titulo')">
          {{ getErrorMessage('titulo') }}
        </span>
        <span class="field-hint" *ngIf="!hasError('titulo') && !gameForm.get('titulo')?.touched">
          Ingresa el nombre completo del videojuego
        </span>
      </div>

      <!-- Plataforma y G√©nero -->
      <div class="form-row">
        <div class="form-group">
          <label for="plataforma">
            Plataforma <span class="required">*</span>
          </label>
          <select 
            id="plataforma" 
            formControlName="plataforma"
            [class.is-invalid]="hasError('plataforma')"
            [class.is-valid]="gameForm.get('plataforma')?.valid && gameForm.get('plataforma')?.touched"
          >
            <option value="" disabled>Selecciona una plataforma</option>
            <option *ngFor="let plat of plataformas" [value]="plat">{{ plat }}</option>
          </select>
          <span class="error-message" *ngIf="hasError('plataforma')">
            {{ getErrorMessage('plataforma') }}
          </span>
        </div>

        <div class="form-group">
          <label for="genero">
            G√©nero <span class="required">*</span>
          </label>
          <select 
            id="genero" 
            formControlName="genero"
            [class.is-invalid]="hasError('genero')"
            [class.is-valid]="gameForm.get('genero')?.valid && gameForm.get('genero')?.touched"
          >
            <option value="" disabled>Selecciona un g√©nero</option>
            <option *ngFor="let gen of generos" [value]="gen">{{ gen }}</option>
          </select>
          <span class="error-message" *ngIf="hasError('genero')">
            {{ getErrorMessage('genero') }}
          </span>
        </div>
      </div>

      <!-- A√±o y Estado -->
      <div class="form-row">
        <div class="form-group">
          <label for="anioLanzamiento">
            A√±o de Lanzamiento <span class="required">*</span>
          </label>
          <input 
            type="number" 
            id="anioLanzamiento" 
            formControlName="anioLanzamiento"
            placeholder="2024"
            [min]="minYear"
            [max]="maxYear"
            [class.is-invalid]="hasError('anioLanzamiento')"
            [class.is-valid]="gameForm.get('anioLanzamiento')?.valid && gameForm.get('anioLanzamiento')?.touched"
          />
          <span class="error-message" *ngIf="hasError('anioLanzamiento')">
            {{ getErrorMessage('anioLanzamiento') }}
          </span>
          <span class="field-hint" *ngIf="!hasError('anioLanzamiento') && !gameForm.get('anioLanzamiento')?.touched">
            Entre {{ minYear }} y {{ maxYear }}
          </span>
        </div>

        <div class="form-group">
          <label for="estado">
            Estado <span class="required">*</span>
          </label>
          <select 
            id="estado" 
            formControlName="estado"
            [class.is-valid]="gameForm.get('estado')?.valid && gameForm.get('estado')?.touched"
          >
            <option *ngFor="let est of estados" [value]="est">
              {{ est === 'Completado' ? '‚úÖ ' : est === 'Jugando' ? 'üéÆ ' : '‚è≥ ' }}{{ est }}
            </option>
          </select>
        </div>
      </div>

      <!-- Calificaci√≥n y Fecha -->
      <div class="form-row">
        <div class="form-group">
          <label for="calificacion">
            Calificaci√≥n ‚≠ê <span class="optional">(opcional)</span>
          </label>
          <input 
            type="number" 
            id="calificacion" 
            formControlName="calificacion"
            placeholder="8"
            min="0"
            max="10"
            step="1"
            [class.is-invalid]="hasError('calificacion')"
            [class.is-valid]="gameForm.get('calificacion')?.valid && gameForm.get('calificacion')?.value && gameForm.get('calificacion')?.touched"
          />
          <span class="error-message" *ngIf="hasError('calificacion')">
            {{ getErrorMessage('calificacion') }}
          </span>
          <span class="field-hint" *ngIf="!hasError('calificacion') && !gameForm.get('calificacion')?.touched">
            De 0 a 10 (deja vac√≠o si a√∫n no lo calificas)
          </span>
        </div>

        <div class="form-group">
          <label for="fechaAdquisicion">
            Fecha de Adquisici√≥n <span class="required">*</span>
          </label>
          <input 
            type="date" 
            id="fechaAdquisicion" 
            formControlName="fechaAdquisicion"
            [max]="currentDate"
            [class.is-invalid]="hasError('fechaAdquisicion')"
            [class.is-valid]="gameForm.get('fechaAdquisicion')?.valid && gameForm.get('fechaAdquisicion')?.touched"
          />
          <span class="error-message" *ngIf="hasError('fechaAdquisicion')">
            {{ getErrorMessage('fechaAdquisicion') }}
          </span>
        </div>
      </div>

      <!-- Nota informativa -->
      <div class="form-info" *ngIf="!gameForm.valid && gameForm.touched">
        <span class="info-icon">‚ÑπÔ∏è</span>
        <span>Por favor completa todos los campos obligatorios marcados con <span class="required">*</span></span>
      </div>

      <!-- Botones -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn-cancel" 
          (click)="onCancel()"
          [disabled]="isSubmitting"
        >
          ‚ùå Cancelar
        </button>
        <button 
          type="submit" 
          class="btn-submit" 
          [disabled]="gameForm.invalid || isSubmitting"
          [class.loading]="isSubmitting"
        >
          <span *ngIf="!isSubmitting">
            {{ isEditMode ? 'üíæ Actualizar' : '‚úÖ Guardar' }}
          </span>
          <span *ngIf="isSubmitting">
            ‚è≥ Guardando...
          </span>
        </button>
      </div>

    </form>
  </div>
</div>